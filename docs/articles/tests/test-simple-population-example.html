<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tests: The Simple Linear Regression Model â€¢ jeksterslabRlinreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Tests: The Simple Linear Regression Model">
<meta property="og:description" content="jeksterslabRlinreg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">jeksterslabRlinreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/jeksterslabRlinreg.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li>
  <a href="../../articles/index.html">Articles</a>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jeksterslabds/jeksterslabRlinreg/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="test-simple-population-example_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tests: The Simple Linear Regression Model</h1>
                        <h4 class="author">Ivan Jacob Agaloos Pesigan</h4>
            
            <h4 class="date">2020-12-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jeksterslabds/jeksterslabRlinreg/blob/master/vignettes/tests/test-simple-population-example.Rmd"><code>vignettes/tests/test-simple-population-example.Rmd</code></a></small>
      <div class="hidden name"><code>test-simple-population-example.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The Simple Linear Regression Model: The Population Regression Model Example {#simple-population-example}</span></code></pre></div>
<p>The <code>jeksterslabRlinreg</code> package has functions to derive expectations for regression models.</p>
<ul>
<li>
<code><a href="../../reference/mutheta.html">jeksterslabRlinreg::mutheta()</a></code> returns the expected values, that is, the model-implied mean vector.</li>
<li>
<code><a href="../../reference/Sigmatheta.html">jeksterslabRlinreg::Sigmatheta()</a></code> returns the covariance expectations, that is, the model-implied variance-covariance matrix.</li>
</ul>
<p>In this hypothetical example, we assume that we have population data and we are interested in the association between wages and education. The regressor variable is years of education. The regressand variable is hourly wage in US dollars. The intercept is the predicted wage of an employee with 0 years of education. The slope is the increase in hourly wage in US dollars for one year increase in education.</p>
<p><img src="test-simple-population-example_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>The the following vectors represent the parameters of the simple linear regression model.</p>
<p><span class="math display">\[\begin{equation}
  \boldsymbol{\theta}_{\text{mean structure}}
  =
  \begin{bmatrix}
    \beta_1 \\
    \mu_x
  \end{bmatrix}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
  \boldsymbol{\theta}_{\text{covariance structure}}
  =
  \begin{bmatrix}
    \beta_2 \\
    \sigma_{\varepsilon}^{2} \\
    \sigma_{x}^{2}
  \end{bmatrix}
\end{equation}\]</span></p>
<table class="table">
<caption><span class="math inline">\(\boldsymbol{\theta}_{\text{mean structure}}\)</span></caption>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
<th align="left">Notation</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>beta1</code></td>
<td align="left">Intercept</td>
<td align="left"><span class="math inline">\(\beta_1\)</span></td>
<td align="right">-4.119577</td>
</tr>
<tr class="even">
<td align="left"><code>mux</code></td>
<td align="left">Mean of <span class="math inline">\(x\)</span>
</td>
<td align="left"><span class="math inline">\(\mu_x\)</span></td>
<td align="right">13.137516</td>
</tr>
</tbody>
</table>
<table class="table">
<caption><span class="math inline">\(\boldsymbol{\theta}_{\text{covariance structure}}\)</span></caption>
<thead><tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
<th align="left">Notation</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>beta2</code></td>
<td align="left">Slope</td>
<td align="left"><span class="math inline">\(\beta_2\)</span></td>
<td align="right">1.249177</td>
</tr>
<tr class="even">
<td align="left"><code>sigma2epsilon</code></td>
<td align="left">Variance of <span class="math inline">\(\varepsilon\)</span>
</td>
<td align="left"><span class="math inline">\(\sigma_{\varepsilon}^{2}\)</span></td>
<td align="right">50.442669</td>
</tr>
<tr class="odd">
<td align="left"><code>sigma2x</code></td>
<td align="left">Variance of <span class="math inline">\(x\)</span>
</td>
<td align="left"><span class="math inline">\(\sigma_{x}^{2}\)</span></td>
<td align="right">8.185725</td>
</tr>
</tbody>
</table>
<p>There are times when the intercept does not lend to a meaningful interpretation. A negative wage corresponding to zero years of education does not really make a lot of sense. The value that is interesting in this case is the slope. The slope represents 1.2491767 US dollar increase in hourly wages given 1 additional year of education.</p>
<p>The expected values are derived using <code><a href="../../reference/mutheta.html">jeksterslabRlinreg::mutheta()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_mutheta</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/mutheta.html">mutheta</a></span><span class="op">(</span>
  beta <span class="op">=</span> <span class="va">beta</span>,
  muX <span class="op">=</span> <span class="va">mux</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<caption>Expected Values</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(\mu\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">y</td>
<td align="right">12.29150</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">13.13752</td>
</tr>
</tbody>
</table>
<p>The covariance expectations are derive using <code><a href="../../reference/Sigmatheta.html">jeksterslabRlinreg::Sigmatheta()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_Sigmatheta</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/Sigmatheta.html">Sigmatheta</a></span><span class="op">(</span>
  slopes <span class="op">=</span> <span class="va">beta2</span>,
  sigma2epsilon <span class="op">=</span> <span class="va">sigma2epsilon</span>,
  SigmaX <span class="op">=</span> <span class="va">sigma2x</span>
<span class="op">)</span></code></pre></div>
<table class="table">
<caption>Covariance Expectations</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">y</th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">y</td>
<td align="right">63.21602</td>
<td align="right">10.225417</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">10.22542</td>
<td align="right">8.185725</td>
</tr>
</tbody>
</table>
<p>The inverse, that is, deriving the parameters from the expectations can also be done using functions from the <code>jeksterslabRlinreg</code> package.</p>
<p>The regression coefficients can be derived using <code><a href="../../reference/intercept.html">jeksterslabRlinreg::intercept()</a></code>, and <code><a href="../../reference/slopes.html">jeksterslabRlinreg::slopes()</a></code> from the means and the covariances.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_slopes</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/.slopes.html">.slopes</a></span><span class="op">(</span>
  SigmaX <span class="op">=</span> <span class="va">sigma2x</span>,
  sigmayX <span class="op">=</span> <span class="va">sigmayx</span>
<span class="op">)</span>
<span class="va">result_slopes</span>
<span class="co">#&gt;        slopes</span>
<span class="co">#&gt; [1,] 1.249177</span>
<span class="va">result_intercept</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/.intercept.html">.intercept</a></span><span class="op">(</span>
  slopes <span class="op">=</span> <span class="va">result_slopes</span>,
  muy <span class="op">=</span> <span class="va">muy</span>,
  muX <span class="op">=</span> <span class="va">mux</span>
<span class="op">)</span>
<span class="va">result_intercept</span>
<span class="co">#&gt; [1] -4.119577</span></code></pre></div>
<p>From raw data</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_slopesfromrawdata</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/slopes.html">slopes</a></span><span class="op">(</span>
  X <span class="op">=</span> <span class="va">X</span>,
  y <span class="op">=</span> <span class="va">y</span>
<span class="op">)</span>
<span class="va">result_slopesfromrawdata</span>
<span class="co">#&gt;             slopes</span>
<span class="co">#&gt; education 1.249177</span>
<span class="va">result_interceptfromrawdata</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/intercept.html">intercept</a></span><span class="op">(</span>
  X <span class="op">=</span> <span class="va">X</span>,
  y <span class="op">=</span> <span class="va">y</span>
<span class="op">)</span>
<span class="va">result_interceptfromrawdata</span>
<span class="co">#&gt;     wages </span>
<span class="co">#&gt; -4.119577</span></code></pre></div>
<p>Standardized slopes can also be obtained using <code><a href="../../reference/slopesprime.html">jeksterslabRlinreg::slopesprime()</a></code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_slopesprime</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/.slopesprime.html">.slopesprime</a></span><span class="op">(</span>
  RX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma2x</span><span class="op">)</span>,
  ryX <span class="op">=</span> <span class="va">ryx</span>
<span class="op">)</span>
<span class="va">result_slopesprime</span>
<span class="co">#&gt;      std.slopes</span>
<span class="co">#&gt; [1,]  0.1571123</span></code></pre></div>
<p>From raw data</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_slopesprimefromrawdata</span> <span class="op">&lt;-</span> <span class="fu">jeksterslabRlinreg</span><span class="fu">::</span><span class="fu"><a href="../../reference/slopesprime.html">slopesprime</a></span><span class="op">(</span>
  X <span class="op">=</span> <span class="va">X</span>,
  y <span class="op">=</span> <span class="va">y</span>
<span class="op">)</span>
<span class="va">result_slopesprimefromrawdata</span>
<span class="co">#&gt;           std.slopes</span>
<span class="co">#&gt; education  0.4495095</span></code></pre></div>
<p>The error variance can also be derived with the available information using <code>jeksterslabRlinreg::sigma2()</code> .</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result_sigma2epsilon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sigma2epsilon.html">sigma2epsilon</a></span><span class="op">(</span>
  slopes <span class="op">=</span> <span class="va">beta2</span>,
  sigma2y <span class="op">=</span> <span class="va">sigma2y</span>,
  sigmayX <span class="op">=</span> <span class="va">sigmayx</span>,
  SigmaX <span class="op">=</span> <span class="va">sigma2x</span>
<span class="op">)</span>
<span class="va">result_sigma2epsilon</span>
<span class="co">#&gt;          </span>
<span class="co">#&gt; 50.44267</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">context</span><span class="op">(</span><span class="st">"Test simple-regression-ram"</span><span class="op">)</span>
<span class="fu">test_that</span><span class="op">(</span><span class="st">"result_mutheta"</span>, <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">result_mutheta</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu">expect_equivalent</span><span class="op">(</span>
      <span class="va">result_mutheta</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>,
      <span class="va">mutheta</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Test passed ðŸ¥³</span>
<span class="fu">test_that</span><span class="op">(</span><span class="st">"result_Sigmatheta"</span>, <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">result_Sigmatheta</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">result_Sigmatheta</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu">expect_equivalent</span><span class="op">(</span>
        <span class="va">result_Sigmatheta</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span>,
        <span class="va">Sigmatheta</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span>
      <span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Test passed ðŸŒˆ</span>
<span class="fu">test_that</span><span class="op">(</span><span class="st">"results_beta"</span>, <span class="op">{</span>
  <span class="va">results_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="va">result_intercept</span>,
    <span class="va">result_slopes</span>
  <span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">results_beta</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu">expect_equivalent</span><span class="op">(</span>
      <span class="va">results_beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
      <span class="va">beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Test passed ðŸ¥‡</span>
<span class="fu">test_that</span><span class="op">(</span><span class="st">"results_betafromrawdata"</span>, <span class="op">{</span>
  <span class="va">results_betafromrawdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="va">result_interceptfromrawdata</span>,
    <span class="va">result_slopesfromrawdata</span>
  <span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">results_betafromrawdata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu">expect_equivalent</span><span class="op">(</span>
      <span class="va">results_betafromrawdata</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
      <span class="va">beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span>
<span class="co">#&gt; Test passed ðŸ˜€</span></code></pre></div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
